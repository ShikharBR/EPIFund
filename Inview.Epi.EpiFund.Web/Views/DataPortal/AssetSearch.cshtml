@model Inview.Epi.EpiFund.Domain.ViewModel.SavedAssetSearchViewModel

@{
    ViewBag.Title = "Asset Search";
    Layout = "~/Views/Shared/_LayoutSearch.cshtml";
}

<!-- DataTables Stuff -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.18/b-1.5.2/r-2.2.2/datatables.min.css" />
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.18/b-1.5.2/r-2.2.2/datatables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.10.19/api/page.jumpToData().js"></script>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
@*<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDqYSKwQkzv0nPfRWWRiVNOVoMIAQjSrok"></script>*@
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBV3nTZqDmBaifM8IRM_XHMTFeobjfckLw"></script>

<style>
    .favorite-asset {
    }

    .favorite-asset-card {
        background-color: #e2ddd2;
    }

    .favorite-groups {
        font-size: 18px;
        font-weight: bold;
    }

        .favorite-groups a {
            font-size: 16px;
            font-weight: bold;
        }

    .modal {
        text-align: center;
        padding: 0 !important;
    }

        .modal:before {
            content: '';
            display: inline-block;
            height: 100%;
            vertical-align: middle;
            margin-right: -4px;
        }

    #savedSearchPrompt.modal:before {
        content: '';
        display: inline-block;
        height: 30%;
        vertical-align: middle;
        margin-right: -4px;
    }

    .modal-dialog {
        display: inline-block;
        text-align: left;
        vertical-align: middle;
    }

    td {
        text-align: center;
    }

    .table th {
        text-align: center;
    }

    .table {
        border-radius: 5px;
        margin: auto;
        float: none;
    }
</style>

<div class="loading"></div>
<div id="asset-search" style="height:100%;"></div>


<!-- #region Favorites and Saved Search modals -->
<!-- Modal to add an asset to a favorite group -->
<div class="modal fade text-left" id="favoritesModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="createGroupLabel">Choose a Favorite Group</h2>
            </div>
            <div class="modal-body container-fluid">
                <div class="row">
                    <div class="col-sm-6 favorite-asset">

                        <div class="favorite-asset-card">
                            <table class="table" border="0">
                                <tbody>
                                    <tr>
                                        <td colspan="2" style="padding: 0px;">
                                            <img src="" id="imgFavAsset" style="display:block;height:auto;" width="100%" />
                                            <input id="hiddenAssetId" name="assetId" type="hidden" value="">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" style="border-top: 0; background-color: dimgray;">
                                            <span id="txtFavAssetType" style="color: white;"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2" style="border-top: 0">
                                            <span id="txtFavAssetTitle"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="1" style="border-top: 0">
                                            <span id="txtFavAssetAvailability"></span>
                                        </td>
                                        <td colspan="1" style="border-top: 0">
                                            <span id="txtFavAssetSGI"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="1" style="border-top: 0">
                                            <span id="txtFavAssetPrice"></span>
                                        </td>
                                        <td colspan="1" style="border-top: 0">
                                            <span id="txtFavAssetNOI"></span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="1" style="border-top: 0">
                                            <span id="txtFavAssetSqFt"></span>
                                        </td>
                                        <td colspan="1" style="border-top: 0">
                                            <span id="txtFavAssetCAP"></span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                    <div class="col-sm-6 favorite-groups">
                        <a id="favGroupListHref" href="@Url.Action("ManageFavoriteGroups", "Asset")" style="text-decoration:none" target="_blank">
                            <h3 id="favGroupListTitle" class="text-center">Favorite Groups</h3>
                        </a>
                        <span id="favGroupListAlert"></span>
                        <table class="table" id="favGroupList">
                            <!-- Body and rows are inserted via React -->
                        </table>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                <button type="button" id="btnCreateNewGroup" class="btn btn-primary" data-toggle="modal" data-target="#createFavoriteGroup" data-dismiss="modal">Create New Group</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to create a new favorite group -->
<div class="modal fade text-left" id="createFavoriteGroup" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="createGroupLabel">Create Group</h2>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="favorite-group-name">Name</label>
                    <input type="text" class="form-control" id="favorite-group-name" placeholder="Enter Favorite Group name">
                </div>
                <div class="form-group">
                    <label for="favorite-group-description">Description</label>
                    <input type="text" class="form-control" id="favorite-group-description" placeholder="Enter Favorite Group description">
                </div>
            </div>
            <div class="modal-footer" id="createFavoriteGroupButtons">
                <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#favoritesModal" data-dismiss="modal">Cancel</button>
                <button class="btn btn-primary" id="btnCreateFavoriteGroup">Create</button>
            </div>
        </div>
    </div>
</div>

<!-- General asset search prompt -->
<div class="modal fade text-left" id="assetSearchPrompt" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="assetSearchPromptLabel"></h2>
            </div>
            <div class="modal-body">
                <span id="assetSearchPromptText"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal to confirm that a saved search has been created / User needs to log in to create a saved search -->
<div class="modal fade text-left" id="savedSearchPrompt" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="savedSearchPromptLabel"></h2>
            </div>
            <div class="modal-body">
                <span id="savedSearchPromptText"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<!-- Favorites modal prompt -->
<div class="modal fade text-left" id="favoritePrompt" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="favoritePromptLabel">Success</h2>
            </div>
            <div class="modal-body">
                <span id="favoritePromptText"></span>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Confirm</button>
            </div>
        </div>
    </div>
</div>

<!-- #endregion -->
<!-- Advanced Filter -->
<div class="modal fade verticaltop" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog as-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header advancedheaderstyle">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top: -3px;"><span aria-hidden="true" style="color: #ffffff !important;">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Advanced Search</h4>
            </div>
            <div id="AdvFilterReactRoot" class="modal-body flex-container">

            </div>


            <div class="modal-footer">
                <div id="myModalFooter"></div>
                <button type="button" class="btn btn-danger buttonstyle generalinputstyle_red" data-dismiss="modal">Close</button>
                <button id="afClearAll" type="button" class="btn btn-danger buttonstyle generalinputstyle_red">Clear Filters</button>
                <button type="button" class="btn btn-danger buttonstyle generalinputstyle_blue" id="btnAdvancedSearch" onclick="advancedSearch();">Search</button>
            </div>
        </div>
    </div>
</div>

<!-- This is hidden until the user toggles it via the layout icon -->
<div id="oneLineSummariesContainerWrapper"></div>
<div class="col-sm-12" id="oneLineSummariesContainer" style="display:none; overflow-y:scroll; padding-top:20px; padding-bottom:20px; background-color:#FAF5EA;">
    <table id="assetSearchOneLineSummariesTable" class="display compact" style="font-size: 10px; width:100%;">
        <thead>
            <tr>
                <th>AssetId</th>
                <th>PortfolioId</th>
                <th></th> <!-- Favorites star goes here -->
                <th title="Name">Asset Name</th>
                <th title="Property Address">Property  Address</th>
                <th title="City, State, Zip">City, St, Zip</th>
                <th title="Asset Type">Type</th>
                <th title="Units/SqFt">U/ SqFt</th>
                <th title="Occupancy % Month/Year">Occ% M/Y</th>
                <th title="Scheduled Gross Rental Income">SGI</th>
                <th title="Net Operating Income">NOI</th>
                <th title="Capitalization Rate">CR</th>
                <th title="Assumable Financing">AF</th>
                <th>Price</th>
                <th title="List Price / Calculated Market Value">LP/ CMV</th>
                <th title="Asset in Portfolio"><span class="glyphicon glyphicon-book"></span></th>
                <th title="Status">STAT</th>
                <th title="Call for Offers Date">COD</th>
                <th title="Auction Date">AUC</th>
                <th title="Action">ACT</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>
